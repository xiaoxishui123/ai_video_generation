# AI视频生成插件 v0.0.63 更新日志

## 发布日期
2026-01-05

## 🔧 Bug修复：视频时长无法传递到工作流

### 问题描述
工作流使用 `tool.text` 接收视频生成结果，但 `duration` 字段只在 `tool.json` 输出中，导致工作流无法获取视频实际时长。

### 修复方案
修改文本输出格式，在第一行输出完整的JSON数据：

**修复前**（文本输出）：
```
https://xxx.mp4

---
🎉 **视频生成完成！**
...
```

**修复后**（文本输出）：
```json
{"video_url": "https://xxx.mp4", "duration": 9.15, "status": "succeeded"}

---
🎉 **视频生成完成！**
📹 视频URL: https://xxx.mp4
⏱️ 实际时长: 9.15秒
...
```

### 工作流兼容性
- ✅ `code_extract_video` 节点可以正确解析JSON获取 `duration`
- ✅ 向后兼容：旧工作流仍然可以从文本中提取URL

---

## 📋 变更文件

- `tools/text_to_video.py` - 修改文本输出格式，包含JSON数据
- `manifest.yaml` - 版本号更新

---

## 🧪 验证方法

1. 运行口播视频工作流
2. 检查剪映草稿中视频片段的时间轴
3. 确认各片段的时长与旁白时长一致

